<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Forward inclusion tests with latent factor mixed models — forward_test • lfmm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">lfmm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="../articles/lfmm">Tutorial</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bcm-uga/lfmm.html">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Forward inclusion tests with latent factor mixed models</h1>
    </div>

    
    <p>This function tests for association between each column of the response matrix, Y,
and the explanatory variables, X, by recursively including the top hits in the set
of explanatory variables. The recursive tests are based on LFMMs with ridge
penalty.</p>
    

    <pre class="usage"><span class='fu'>forward_test</span>(<span class='no'>Y</span>, <span class='no'>X</span>, <span class='no'>K</span>, <span class='kw'>niter</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>candidate.list</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1e-04</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>a response variable matrix with n rows and p columns.
Each column is a response variable (numeric).</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>an explanatory variable matrix with n rows and d = 1 column (eg. phenotype).</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>an integer for the number of latent factors in the regression model.</p></td>
    </tr>
    <tr>
      <th>niter</th>
      <td><p>an integer value for the number of forward inclusion tests.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>a local value, <code>TRUE</code> if the explanatory variable, X, is scaled
(recommended option).</p></td>
    </tr>
    <tr>
      <th>candidate.list</th>
      <td><p>a vector of integers corresponding to columns in Y, and evaluated
as top hits in previous association analysis. If <code>NULL</code>, a list of candidates
is built from the first LFMM top hit.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>a numeric value for the regularization parameter.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with the following attributes:</p><ul>
<li><p>candidates a vector of niter candidate variables (columns of Y),</p></li>
<li><p>log.p a vector of uncorrected log p-values for checking (not trustable for testing).</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The response variable matrix Y and the explanatory variable are centered.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>lfmm</span>)
<span class='fu'>data</span>(<span class='st'>"example.data"</span>)
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='no'>example.data</span>$<span class='no'>genotype</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='no'>example.data</span>$<span class='no'>phenotype</span> <span class='co'>#scaled variable</span>

<span class='co'>## fits an LFMM, i.e, computes B, U, V:</span>
<span class='no'>mod.lfmm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lfmm_ridge.html'>lfmm_ridge</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>,
                       <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>,
                       <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>6</span>)

<span class='co'>## performs initial association testing using the fitted model:</span>
<span class='no'>pv</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lfmm_test.html'>lfmm_test</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>,
                <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>,
                <span class='kw'>lfmm</span> <span class='kw'>=</span> <span class='no'>mod.lfmm</span>,
                <span class='kw'>calibrate</span> <span class='kw'>=</span> <span class='st'>"gif"</span>)
<span class='co'>## Manhattan plot </span>
<span class='fu'>plot</span>(-<span class='fu'>log10</span>(<span class='no'>pv</span>$<span class='no'>calibrated.pvalue</span>),
      <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>,
      <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.2</span>,
      <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"grey"</span>)</div><div class='img'><img src='forward_test-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
<span class='co'>## Start forward tests (3 iterations)       </span>
<span class='no'>obj</span> <span class='kw'>&lt;-</span> <span class='fu'>forward_test</span>(<span class='no'>Y</span>,
                    <span class='no'>X</span>,
                    <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>6</span>,
                    <span class='kw'>niter</span> <span class='kw'>=</span> <span class='fl'>3</span>,
                    <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Record Log p.values for the 3 top hits</span>
<span class='no'>log.p</span> <span class='kw'>&lt;-</span>  <span class='no'>obj</span>$<span class='no'>log.p</span>
<span class='no'>log.p</span></div><div class='output co'>#&gt; [1] 5.927181 4.477862 4.781035</div><div class='input'>
<span class='co'>## Check perfect hits for each causal SNPs (labelled from 1 to 20)</span>
<span class='no'>obj</span>$<span class='no'>candidate</span> <span class='kw'>%in%</span> <span class='no'>example.data</span>$<span class='no'>causal.set</span></div><div class='output co'>#&gt; [1] TRUE TRUE TRUE</div><div class='input'>
<span class='co'>## Check for candidates at distance 20 SNPs (about 10kb)</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fl'>20</span>
<span class='co'>## Number of hits for each causal SNPs (1-20)</span>
 <span class='no'>hit.3</span> <span class='kw'>&lt;-</span> <span class='fu'>as.numeric</span>(
          <span class='fu'>apply</span>(<span class='fu'>sapply</span>(<span class='no'>obj</span>$<span class='no'>candidate</span>,
          <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>abs</span>(<span class='no'>x</span> - <span class='no'>example.data</span>$<span class='no'>causal.set</span>) <span class='kw'>&lt;</span> <span class='no'>theta</span>),
          <span class='fl'>2</span>,
          <span class='no'>which</span>))
<span class='co'>## Number of hits for each causal SNPs (1-20) </span>
<span class='fu'>table</span>(<span class='no'>hit.3</span>)</div><div class='output co'>#&gt; hit.3
#&gt;  7 16 19 
#&gt;  1  1  1 </div><div class='input'>

<span class='co'>## Continue forward tests (2 additional iterations)       </span>
<span class='no'>obj</span> <span class='kw'>&lt;-</span> <span class='fu'>forward_test</span>(<span class='no'>Y</span>,
                    <span class='no'>X</span>,
                    <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>6</span>,
                    <span class='kw'>niter</span> <span class='kw'>=</span> <span class='fl'>2</span>,
                    <span class='kw'>candidate.list</span> <span class='kw'>=</span> <span class='no'>obj</span>$<span class='no'>candidates</span>,
                    <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Record Log p.values for all 5 top hits</span>
<span class='no'>log.p</span> <span class='kw'>&lt;-</span>  <span class='fu'>c</span>(<span class='no'>log.p</span>, <span class='no'>obj</span>$<span class='no'>log.p</span>)
<span class='no'>log.p</span></div><div class='output co'>#&gt; [1] 5.927181 4.477862 4.781035 4.828443 5.300978</div><div class='input'>
<span class='co'>## Check perfect hits for each causal SNPs (labelled from 1 to 20)</span>
<span class='no'>obj</span>$<span class='no'>candidate</span> <span class='kw'>%in%</span> <span class='no'>example.data</span>$<span class='no'>causal.set</span></div><div class='output co'>#&gt; [1]  TRUE  TRUE  TRUE FALSE  TRUE</div><div class='input'>
<span class='co'>## Check for candidates at distance 20 SNPs (about 10kb)</span>
<span class='no'>theta</span> <span class='kw'>&lt;-</span> <span class='fl'>20</span>
<span class='co'>## Number of hits for each causal SNPs (1-20)</span>
 <span class='no'>hit.5</span> <span class='kw'>&lt;-</span> <span class='fu'>as.numeric</span>(
          <span class='fu'>apply</span>(<span class='fu'>sapply</span>(<span class='no'>obj</span>$<span class='no'>candidate</span>,
          <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'>abs</span>(<span class='no'>x</span> - <span class='no'>example.data</span>$<span class='no'>causal.set</span>) <span class='kw'>&lt;</span> <span class='no'>theta</span>),
          <span class='fl'>2</span>,
          <span class='no'>which</span>))
<span class='co'>## Number of hits for each causal SNPs (1-20)          </span>
<span class='fu'>table</span>(<span class='no'>hit.5</span>)</div><div class='output co'>#&gt; hit.5
#&gt;  7 10 14 16 19 
#&gt;  1  1  1  1  1 </div><div class='input'>
<span class='co'>## Plot log P</span>
<span class='fu'>plot</span>(<span class='no'>obj</span>$<span class='no'>log.p</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Iteration"</span>)</div><div class='img'><img src='forward_test-2.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
cayek, francoio

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kevin Caye, Olivier François.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
