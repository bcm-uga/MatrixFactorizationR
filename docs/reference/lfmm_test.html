<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Statistical tests with latent factor mixed models — lfmm_test • lfmm</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">lfmm</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="../articles/lfmm">Tutorial</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bcm-uga/lfmm.html">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistical tests with latent factor mixed models</h1>
    </div>

    
    <p>This function returns significance values for the association between each column of the
response matrix, Y, and the explanatory variables, X, including correction for unobserved confounders
(latent factors). The test is based on an LFMM fitted with a ridge or lasso penalty.</p>
    

    <pre class="usage"><span class='fu'>lfmm_test</span>(<span class='no'>Y</span>, <span class='no'>X</span>, <span class='no'>lfmm</span>, <span class='kw'>calibrate</span> <span class='kw'>=</span> <span class='st'>"gif"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>a response variable matrix with n rows and p columns.
Each column is a response variable (numeric).</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>an explanatory variable matrix with n rows and d columns.
Each column corresponds to an explanatory variable (numeric).</p></td>
    </tr>
    <tr>
      <th>lfmm</th>
      <td><p>an object of class <code>lfmm</code> returned by the <a href='lfmm_lasso.html'>lfmm_lasso</a>
or <a href='lfmm_ridge.html'>lfmm_ridge</a> function</p></td>
    </tr>
    <tr>
      <th>calibrate</th>
      <td><p>a character string, "gif" or "median+MAD". If the "gif" option is set (default),
significance values are calibrated by using the genomic control method. Genomic control
uses a robust estimate of the variance of z-scores called "genomic inflation factor".
If the "median+MAD" option is set, the pvalues are calibrated by computing the median and MAD of the zscores. If <code>NULL</code>, the
pvalues are not calibrated.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with the following attributes:</p><ul>
<li><p>B the effect size matrix with dimensions p x d.</p></li>
<li><p>score a p x d matrix which contains z-scores for each explanatory variable (columns of X),</p></li>
<li><p>pvalue a p x d matrix which contains p-values for each explanatory variable,</p></li>
<li><p>calibrated.pvalue a p x d matrix which contains calibrated p-values for each explanatory variable,</p></li>
<li><p>gif a numeric value for the genomic inflation factor.</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The response variable matrix Y and the explanatory variable are centered.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>library</span>(<span class='no'>lfmm</span>)

<span class='co'>## a GWAS example with Y = SNPs and X = phenotype</span>
<span class='fu'>data</span>(<span class='no'>example.data</span>)
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='no'>example.data</span>$<span class='no'>genotype</span>
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='no'>example.data</span>$<span class='no'>phenotype</span>

<span class='co'>## Fit an LFMM with K = 6 factors</span>
<span class='no'>mod.lfmm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lfmm_ridge.html'>lfmm_ridge</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>,
                       <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>,
                       <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>6</span>)
<<<<<<< HEAD

<span class='co'>## Perform association testing using the fitted model:</span>
<span class='no'>pv</span> <span class='kw'>&lt;-</span> <span class='fu'>lfmm_test</span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>,
                <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>,
                <span class='kw'>lfmm</span> <span class='kw'>=</span> <span class='no'>mod.lfmm</span>,
                <span class='kw'>calibrate</span> <span class='kw'>=</span> <span class='st'>"gif"</span>)

<span class='co'>## Manhattan plot with causal loci shown</span>

=======

<span class='co'>## Perform association testing using the fitted model:</span>
<span class='no'>pv</span> <span class='kw'>&lt;-</span> <span class='fu'>lfmm_test</span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>,
                <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>,
                <span class='kw'>lfmm</span> <span class='kw'>=</span> <span class='no'>mod.lfmm</span>,
                <span class='kw'>calibrate</span> <span class='kw'>=</span> <span class='st'>"gif"</span>)

<span class='co'>## Manhattan plot with causal loci shown</span>

>>>>>>> 334de6581f8a3ceeef30ca9a8404c65823dad06c
<span class='no'>pvalues</span> <span class='kw'>&lt;-</span> <span class='no'>pv</span>$<span class='no'>calibrated.pvalue</span>
<span class='fu'>plot</span>(-<span class='fu'>log10</span>(<span class='no'>pvalues</span>), <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>,
     <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.2</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"grey"</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"SNP"</span>)</div><div class='input'><span class='fu'>points</span>(<span class='no'>example.data</span>$<span class='no'>causal.set</span>,
      -<span class='fu'>log10</span>(<span class='no'>pvalues</span>)[<span class='no'>example.data</span>$<span class='no'>causal.set</span>],
       <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>)</div><div class='img'><img src='lfmm_test-1.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>

<span class='co'>## An EWAS example with Y = methylation data and X = exposure</span>
<span class='no'>Y</span> <span class='kw'>&lt;-</span> <span class='fu'>scale</span>(<span class='no'>skin.exposure</span>$<span class='no'>beta.value</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'>scale</span>(<span class='fu'>as.numeric</span>(<span class='no'>skin.exposure</span>$<span class='no'>exposure</span>))

<span class='co'>## Fit an LFMM with 2 latent factors</span>
<span class='no'>mod.lfmm</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lfmm_ridge.html'>lfmm_ridge</a></span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>,
                       <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>,
                       <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'>## Perform association testing using the fitted model:</span>
<span class='no'>pv</span> <span class='kw'>&lt;-</span> <span class='fu'>lfmm_test</span>(<span class='kw'>Y</span> <span class='kw'>=</span> <span class='no'>Y</span>,
                <span class='kw'>X</span> <span class='kw'>=</span> <span class='no'>X</span>,
                <span class='kw'>lfmm</span> <span class='kw'>=</span> <span class='no'>mod.lfmm</span>,
                <span class='kw'>calibrate</span> <span class='kw'>=</span> <span class='st'>"gif"</span>)

<span class='co'>## Manhattan plot with true associations shown</span>
<span class='no'>pvalues</span> <span class='kw'>&lt;-</span> <span class='no'>pv</span>$<span class='no'>calibrated.pvalue</span>
<span class='fu'>plot</span>(-<span class='fu'>log10</span>(<span class='no'>pvalues</span>),
     <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>19</span>,
     <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>.3</span>,
     <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Probe"</span>,
     <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"grey"</span>)</div><div class='input'>
<span class='no'>causal.set</span> <span class='kw'>&lt;-</span> <span class='fu'>seq</span>(<span class='fl'>11</span>, <span class='fl'>1496</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>80</span>)
<span class='fu'>points</span>(<span class='no'>causal.set</span>,
      -<span class='fu'>log10</span>(<span class='no'>pvalues</span>)[<span class='no'>causal.set</span>],
       <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>)</div><div class='img'><img src='lfmm_test-2.png' alt='' width='700' height='432.632880098887' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
cayek

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kevin Caye, Olivier François.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
